<!DOCTYPE html> 
<html lang="en"> 
<head> 
    <meta charset="UTF-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <title>ESP32 Climate Control Dashboard</title> 
    <style> 
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        } 
 
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); 
            min-height: 100vh; 
            padding: 2rem; 
            color: white; 
        } 
 
        .container { 
            max-width: 1400px; 
            margin: 0 auto; 
        } 
 
        .header { 
            background: rgba(255, 255, 255, 0.1); 
            backdrop-filter: blur(10px); 
            border-radius: 1rem; 
            padding: 1.5rem; 
            margin-bottom: 1.5rem; 
            border: 1px solid rgba(255, 255, 255, 0.2); 
        } 
 
        .header-top { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            flex-wrap: wrap; 
            gap: 1rem; 
        } 
 
        h1 { 
            font-size: 2rem; 
            font-weight: bold; 
        } 
 
        .connection-status { 
            display: flex; 
            align-items: center; 
            gap: 0.5rem; 
        } 
 
        .status-dot { 
            width: 12px; 
            height: 12px; 
            border-radius: 50%; 
            background: #ef4444; 
            animation: pulse 2s infinite; 
        } 
 
        .status-dot.connected { 
            background: #22c55e; 
        } 
 
        @keyframes pulse { 
            0%, 100% { opacity: 1; } 
            50% { opacity: 0.5; } 
        } 
 
        .ip-input-group { 
            margin-top: 1rem; 
        } 
 
        .ip-input-group label { 
            display: block; 
            color: rgba(255, 255, 255, 0.7); 
            font-size: 0.875rem; 
            margin-bottom: 0.5rem; 
        } 
 
        .ip-input-group input { 
            width: 100%; 
            padding: 0.75rem 1rem; 
            background: rgba(255, 255, 255, 0.1); 
            border: 1px solid rgba(255, 255, 255, 0.2); 
            border-radius: 0.5rem; 
            color: white; 
            font-size: 1rem; 
        } 
 
        .ip-input-group input:focus { 
            outline: none; 
            border-color: #3b82f6; 
        } 
 
        .grid-2 { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
            gap: 1.5rem; 
            margin-bottom: 1.5rem; 
        } 
 
        .grid-3 { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); 
            gap: 1.5rem; 
        } 
 
        .card { 
            background: rgba(255, 255, 255, 0.1); 
            backdrop-filter: blur(10px); 
            border-radius: 1rem; 
            padding: 1.5rem; 
            border: 1px solid rgba(255, 255, 255, 0.2); 
        } 
 
        .card-header { 
            display: flex; 
            align-items: center; 
            gap: 1rem; 
            margin-bottom: 1rem; 
        } 
 
        .icon-circle { 
            width: 56px; 
            height: 56px; 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 1.75rem; 
            transition: all 0.3s; 
        } 
 
        .icon-circle.temperature { 
            background: #f97316; 
        } 
 
        .icon-circle.humidity { 
            background: #06b6d4; 
        } 
 
        .icon-circle.fan { 
            background: #6b7280; 
        } 
 
        .icon-circle.fan.active { 
            background: #3b82f6; 
            box-shadow: 0 0 25px rgba(59, 130, 246, 0.6); 
            animation: spin 2s linear infinite; 
        } 
 
        @keyframes spin { 
            from { transform: rotate(0deg); } 
            to { transform: rotate(360deg); } 
        } 
 
        .icon-circle.vent { 
            background: #6b7280; 
        } 
 
        .icon-circle.vent.active { 
            background: #22c55e; 
            box-shadow: 0 0 25px rgba(34, 197, 94, 0.6); 
        } 
 
        .card-title { 
            font-size: 1.25rem; 
            font-weight: 600; 
        } 
 
        .card-subtitle { 
            font-size: 0.875rem; 
            color: rgba(255, 255, 255, 0.6); 
        } 
 
        .sensor-display { 
            background: rgba(255, 255, 255, 0.05); 
            border-radius: 0.5rem; 
            padding: 1.5rem; 
            text-align: center; 
            margin-bottom: 1rem; 
        } 
 
        .sensor-value { 
            font-size: 3rem; 
            font-weight: bold; 
            margin-bottom: 0.25rem; 
        } 
 
        .sensor-unit { 
            font-size: 1rem; 
            color: rgba(255, 255, 255, 0.6); 
        } 
 
        .threshold-info { 
            font-size: 0.875rem; 
            color: rgba(255, 255, 255, 0.5); 
            text-align: center; 
            margin-top: 0.5rem; 
        } 
 
        .progress-bar { 
            height: 0.75rem; 
            background: rgba(255, 255, 255, 0.1); 
            border-radius: 9999px; 
            overflow: hidden; 
        } 
 
        .progress-fill { 
            height: 100%; 
            transition: width 0.5s ease; 
            border-radius: 9999px; 
        } 
 
        .progress-fill.temperature { 
            background: linear-gradient(to right, #3b82f6, #f97316, #ef4444); 
        } 
 
        .progress-fill.humidity { 
            background: linear-gradient(to right, #06b6d4, #3b82f6); 
        } 
 
        .status-card { 
            display: flex; 
            align-items: center; 
            justify-content: space-between; 
            padding: 1rem; 
            background: rgba(255, 255, 255, 0.05); 
            border-radius: 0.5rem; 
            margin-bottom: 0.75rem; 
        } 
 
        .status-label { 
            font-size: 0.875rem; 
            color: rgba(255, 255, 255, 0.7); 
        } 
 
        .status-badge { 
            font-size: 0.875rem; 
            font-weight: 600; 
            padding: 0.375rem 0.875rem; 
            border-radius: 9999px; 
            background: rgba(107, 114, 128, 0.3); 
            color: #9ca3af; 
        } 
 
        .status-badge.active { 
            background: rgba(34, 197, 94, 0.3); 
            color: #22c55e; 
        } 
 
        .status-badge.inactive { 
            background: rgba(239, 68, 68, 0.3); 
            color: #ef4444; 
        } 
 
        .reason-text { 
            font-size: 0.875rem; 
            color: rgba(255, 255, 255, 0.6); 
            margin-top: 0.5rem; 
            padding: 0.75rem; 
            background: rgba(255, 255, 255, 0.05); 
            border-radius: 0.5rem; 
            border-left: 3px solid; 
        } 
 
        .reason-text.normal { 
            border-left-color: #22c55e; 
        } 
 
        .reason-text.alert { 
            border-left-color: #f97316; 
        } 
 
        .auto-badge { 
            display: inline-block; 
            background: rgba(59, 130, 246, 0.2); 
            color: #3b82f6; 
            padding: 0.25rem 0.75rem; 
            border-radius: 9999px; 
            font-size: 0.75rem; 
            font-weight: 600; 
            margin-left: 0.5rem; 
        } 
    </style> 
</head> 
<body> 
    <div class="container"> 
        <!-- Header --> 
        <div class="header"> 
            <div class="header-top"> 
                <div> 
                    <h1>ESP32 Climate Control Dashboard</h1> 
                    <span class="auto-badge">  AUTOMATED</span> 
                </div> 
                <div class="connection-status"> 
                    <div class="status-dot" id="statusDot"></div> 
                    <span id="connectionText">Disconnected</span> 
                </div> 
            </div> 
            <div class="ip-input-group"> 
                <label for="espIP">ESP32 IP Address:</label> 
                <input type="text" id="espIP" value="192.168.1.100" 
placeholder="192.168.1.100"> 
            </div> 
        </div> 
 
        <!-- Sensor Readings --> 
        <div class="grid-2"> 
            <!-- Temperature --> 
            <div class="card"> 
                <div class="card-header"> 
                    <div class="icon-circle temperature">    </div> 
                    <div> 
                        <div class="card-title">Temperature</div> 
                        <div class="card-subtitle">Current Reading</div> 
                    </div> 
                </div> 
                <div class="sensor-display"> 
                    <div class="sensor-value" id="tempValue">0.0</div> 
                    <div class="sensor-unit">°C</div> 
                </div> 
                <div class="progress-bar"> 
                    <div class="progress-fill temperature" id="tempProgress" style="width: 
0%"></div> 
                </div> 
                <div class="threshold-info" id="tempThreshold">Threshold: Loading...</div> 
            </div> 
 
            <!-- Humidity --> 
            <div class="card"> 
                <div class="card-header"> 
                    <div class="icon-circle humidity"> </div> 
                    <div> 
                        <div class="card-title">Humidity</div> 
                        <div class="card-subtitle">Current Reading</div> 
                    </div> 
                </div> 
                <div class="sensor-display"> 
                    <div class="sensor-value" id="humidityValue">0.0</div> 
                    <div class="sensor-unit">%</div> 
                </div> 
                <div class="progress-bar"> 
                    <div class="progress-fill humidity" id="humidityProgress" style="width: 
0%"></div> 
                </div> 
                <div class="threshold-info" id="humidityThreshold">Threshold: Loading...</div> 
            </div> 
        </div> 
 
        <!-- Device Status --> 
        <div class="grid-2"> 
            <!-- Fan Status --> 
            <div class="card"> 
                <div class="card-header"> 
                    <div class="icon-circle fan" id="fanIcon"> </div> 
                    <div> 
                        <div class="card-title">Exhaust Fan</div> 
                        <div class="card-subtitle">Temperature Control</div> 
                    </div> 
                </div> 
                <div class="status-card"> 
                    <span class="status-label">Current Status:</span> 
                    <span class="status-badge" id="fanStatus">STOPPED</span> 
                </div> 
                <div class="reason-text normal" id="fanReason"> 
                        Waiting for sensor data... 
                </div> 
            </div> 
 
            <!-- Vent Status --> 
            <div class="card"> 
                <div class="card-header"> 
                    <div class="icon-circle vent" id="ventIcon">     </div> 
                    <div> 
                        <div class="card-title">Ventilation Servo</div> 
                        <div class="card-subtitle">Humidity Control</div> 
                    </div> 
                </div> 
                <div class="status-card"> 
                    <span class="status-label">Current Status:</span> 
                    <span class="status-badge" id="ventStatus">CLOSED</span> 
                </div> 
                <div class="reason-text normal" id="ventReason"> 
                        Waiting for sensor data... 
                </div> 
            </div> 
        </div> 
    </div> 
 
    <script> 
        let ws = null; 
 
        function connectWebSocket() { 
            const espIP = document.getElementById('espIP').value; 
            ws = new WebSocket(`ws://${espIP}:81`); 
 
            ws.onopen = () => { 
                console.log('WebSocket Connected'); 
                updateConnectionStatus(true); 
            }; 
 
            ws.onmessage = (event) => { 
                try { 
                    const data = JSON.parse(event.data); 
                    console.log('Received:', data); 
                     
                    updateTemperature(data.temperature || 0, data.maxTemp || 30); 
                    updateHumidity(data.humidity || 0, data.maxHumidity || 70); 
                    updateFanStatus(data.fan, data.fanReason || 'Unknown'); 
                    updateVentStatus(data.vent, data.ventReason || 'Unknown'); 
                } catch (error) { 
                    console.error('Error parsing message:', error); 
                } 
            }; 
 
            ws.onerror = (error) => { 
                console.error('WebSocket error:', error); 
            }; 
 
            ws.onclose = () => { 
                console.log('WebSocket Disconnected'); 
                updateConnectionStatus(false); 
                setTimeout(connectWebSocket, 3000); 
            }; 
        } 
 
        function updateConnectionStatus(connected) { 
            const statusDot = document.getElementById('statusDot'); 
            const connectionText = document.getElementById('connectionText'); 
 
            if (connected) { 
                statusDot.classList.add('connected'); 
                connectionText.textContent = 'Connected'; 
            } else { 
                statusDot.classList.remove('connected'); 
                connectionText.textContent = 'Disconnected'; 
            } 
        } 
 
        function updateTemperature(temp, maxTemp) { 
            document.getElementById('tempValue').textContent = temp.toFixed(1); 
            document.getElementById('tempThreshold').textContent = `Threshold: ${maxTemp}°C 
(Fan activates above)`; 
             
            const percentage = Math.min((temp / 50) * 100, 100); 
            document.getElementById('tempProgress').style.width = percentage + '%'; 
        } 
 
        function updateHumidity(humidity, maxHumidity) { 
            document.getElementById('humidityValue').textContent = humidity.toFixed(1); 
            document.getElementById('humidityThreshold').textContent = `Threshold: 
${maxHumidity}% (Vent closes above)`; 
             
            const percentage = Math.min(humidity, 100); 
            document.getElementById('humidityProgress').style.width = percentage + '%'; 
        } 
 
        function updateFanStatus(isActive, reason) { 
            const icon = document.getElementById('fanIcon'); 
            const status = document.getElementById('fanStatus'); 
            const reasonText = document.getElementById('fanReason'); 
 
            if (isActive) { 
                icon.classList.add('active'); 
                status.classList.add('active'); 
                status.classList.remove('inactive'); 
                status.textContent = 'RUNNING'; 
                reasonText.className = 'reason-text alert'; 
                reasonText.textContent = `   ${reason} - Cooling in progress`; 
            } else { 
                icon.classList.remove('active'); 
                status.classList.remove('active'); 
                status.classList.add('inactive'); 
                status.textContent = 'STOPPED'; 
                reasonText.className = 'reason-text normal'; 
                reasonText.textContent = `✓ ${reason} - No cooling needed`; 
            } 
        } 
 
        function updateVentStatus(isOpen, reason) { 
            const icon = document.getElementById('ventIcon'); 
            const status = document.getElementById('ventStatus'); 
            const reasonText = document.getElementById('ventReason'); 
 
            if (isOpen) { 
                icon.classList.add('active'); 
                status.classList.add('active'); 
                status.classList.remove('inactive'); 
                status.textContent = 'OPEN'; 
                reasonText.className = 'reason-text normal'; 
                reasonText.textContent = `✓ ${reason} - Ventilation active`; 
            } else { 
                icon.classList.remove('active'); 
                status.classList.remove('active'); 
                status.classList.add('inactive'); 
                status.textContent = 'CLOSED'; 
                reasonText.className = 'reason-text alert'; 
                reasonText.textContent = `  ${reason} - Vent sealed`; 
            } 
        } 
// Connect on page load 
connectWebSocket(); 
</script> 
</body> 
</html>